[global]
   workgroup = {{ samba_workgroup }}
   server string = %h Samba Server
   security = user
   map to guest = Bad User
   dns proxy = no

   # Logging
   log file = /var/log/samba/log.%m
   max log size = 1000

   # Modern protocol defaults
   server min protocol = SMB2
   ntlm auth = yes

{% for share in samba_shares %}
[{{ share.name }}]
   path = {{ share.path }}
   browsable = {{ share.browsable }}
   read only = {{ share.read_only }}
   guest ok = {{ share.guest_ok }}
{% if share.valid_users is defined %}
   valid users = {{ share.valid_users | join(' ') }}
{% endif %}
{% if share.create_mask is defined %}
   create mask = {{ share.create_mask }}
{% endif %}
{% if share.directory_mask is defined %}
   directory mask = {{ share.directory_mask }}
{% endif %}
   force group = {{ share.group | default('sambashare') }}
{% endfor %}

